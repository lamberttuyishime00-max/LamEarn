<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LamEarn ‚Ä¢ Global Work & Marketplace</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- MATERIAL ICONS -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- FIREBASE CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
/* ========== GLOBAL STYLE ========== */
:root {
  --primary: #2563eb;
  --primary-dark: #1d4ed8;
  --secondary: #7c3aed;
  --dark: #0f172a;
  --dark-light: #1e293b;
  --soft: #f1f5f9;
  --soft-dark: #e2e8f0;
  --text: #0f172a;
  --text-light: #64748b;
  --white: #ffffff;
  --danger: #ef4444;
  --success: #10b981;
  --warning: #f59e0b;
  --radius: 14px;
  --radius-sm: 8px;
  --shadow: 0 4px 20px rgba(0,0,0,0.08);
  --shadow-lg: 0 10px 40px rgba(0,0,0,0.15);
  --transition: all 0.3s ease;
}

* {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  margin: 0;
  padding: 0;
}

body {
  background: var(--soft);
  color: var(--text);
  overflow-x: hidden;
}

/* ========== AUTH SCREEN ========== */
#auth {
  max-width: 420px;
  margin: 60px auto;
  background: var(--white);
  padding: 30px;
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

#auth h2 {
  text-align: center;
  margin-bottom: 25px;
  color: var(--dark);
  font-size: 28px;
}

.auth-input-group {
  position: relative;
  margin: 15px 0;
}

.auth-input-group input {
  width: 100%;
  padding: 16px 16px 16px 48px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--soft-dark);
  font-size: 16px;
  transition: var(--transition);
}

.auth-input-group input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.auth-input-group .material-icons {
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-light);
}

.password-toggle {
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-light);
  cursor: pointer;
}

button {
  width: 100%;
  padding: 16px;
  border-radius: var(--radius-sm);
  border: none;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: var(--white);
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
}

button:active {
  transform: translateY(0);
}

.ripple {
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.7);
  transform: scale(0);
  animation: ripple 0.6s linear;
}

@keyframes ripple {
  to {
    transform: scale(4);
    opacity: 0;
  }
}

.google-btn {
  background: var(--white);
  color: var(--text);
  border: 1px solid var(--soft-dark);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-top: 15px;
}

.google-btn:hover {
  background: #f8fafc;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.google-btn img {
  width: 20px;
}

.auth-links {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.auth-links span {
  color: var(--primary);
  cursor: pointer;
  padding: 8px 0;
  transition: var(--transition);
}

.auth-links span:hover {
  text-decoration: underline;
}

/* ========== DASHBOARD ========== */
#dashboard {
  display: none;
}

/* Header */
header {
  height: 64px;
  background: var(--white);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  position: sticky;
  top: 0;
  z-index: 100;
}

.header-left, .header-right {
  display: flex;
  align-items: center;
  gap: 15px;
}

header h1 {
  font-size: 22px;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 700;
}

header .material-icons {
  cursor: pointer;
  padding: 8px;
  border-radius: 50%;
  transition: var(--transition);
}

header .material-icons:hover {
  background: var(--soft);
}

/* Bottom Navigation */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 70px;
  background: var(--white);
  display: flex;
  justify-content: space-around;
  align-items: center;
  box-shadow: 0 -2px 20px rgba(0,0,0,0.08);
  z-index: 100;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: var(--text-light);
  cursor: pointer;
  transition: var(--transition);
  flex: 1;
  height: 100%;
  padding: 8px 0;
}

.nav-item.active {
  color: var(--primary);
}

.nav-item .material-icons {
  font-size: 24px;
  margin-bottom: 4px;
}

.nav-item span {
  font-size: 12px;
  font-weight: 500;
}

.nav-item:hover {
  color: var(--primary);
  background: rgba(37, 99, 235, 0.05);
}

/* Main Content */
main {
  padding: 20px;
  padding-bottom: 90px; /* Space for bottom nav */
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
}

.page {
  display: none;
  animation: fadeIn 0.3s ease;
}

.page.active {
  display: block;
}

/* ========== HOME PAGE - SOCIAL FEED ========== */
.feed {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.post {
  background: var(--white);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: var(--transition);
}

.post:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.post-header {
  display: flex;
  align-items: center;
  padding: 16px;
  gap: 12px;
}

.post-avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  font-size: 18px;
}

.post-user {
  flex: 1;
}

.post-user-name {
  font-weight: 600;
  margin-bottom: 4px;
}

.post-time {
  font-size: 12px;
  color: var(--text-light);
}

.post-options {
  color: var(--text-light);
  cursor: pointer;
}

.post-content {
  padding: 0 16px 16px;
}

.post-text {
  margin-bottom: 16px;
  line-height: 1.5;
}

.post-media {
  width: 100%;
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: 16px;
}

.post-media img, .post-media video {
  width: 100%;
  display: block;
}

.post-stats {
  display: flex;
  justify-content: space-between;
  padding: 0 16px 16px;
  color: var(--text-light);
  font-size: 14px;
}

.post-actions {
  display: flex;
  justify-content: space-around;
  padding: 12px 16px;
  border-top: 1px solid var(--soft);
}

.post-action {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  padding: 8px 16px;
  border-radius: 50px;
  transition: var(--transition);
  color: var(--text-light);
}

.post-action:hover {
  background: var(--soft);
}

.post-action.active {
  color: var(--primary);
}

.post-action.liked {
  color: #ef4444;
}

/* ========== UPLOAD PAGE ========== */
.upload-container {
  background: var(--white);
  border-radius: var(--radius);
  padding: 24px;
  box-shadow: var(--shadow);
}

.upload-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 24px;
}

.upload-type-selector {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.upload-type {
  flex: 1;
  padding: 12px;
  text-align: center;
  border: 2px solid var(--soft);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: var(--transition);
}

.upload-type.active {
  border-color: var(--primary);
  background: rgba(37, 99, 235, 0.05);
}

.upload-preview {
  width: 100%;
  min-height: 200px;
  background: var(--soft);
  border-radius: var(--radius-sm);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  overflow: hidden;
}

.upload-preview img, .upload-preview video {
  max-width: 100%;
  max-height: 300px;
}

.upload-preview-placeholder {
  text-align: center;
  color: var(--text-light);
}

/* ========== INBOX PAGE ========== */
.inbox-container {
  background: var(--white);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.inbox-header {
  padding: 20px;
  border-bottom: 1px solid var(--soft);
}

.chat-list {
  max-height: 500px;
  overflow-y: auto;
}

.chat-item {
  display: flex;
  align-items: center;
  padding: 16px;
  gap: 12px;
  cursor: pointer;
  transition: var(--transition);
  border-bottom: 1px solid var(--soft);
}

.chat-item:hover {
  background: var(--soft);
}

.chat-item.active {
  background: rgba(37, 99, 235, 0.05);
}

.chat-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
}

.chat-info {
  flex: 1;
}

.chat-name {
  font-weight: 600;
  margin-bottom: 4px;
}

.chat-last-message {
  font-size: 14px;
  color: var(--text-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-meta {
  text-align: right;
}

.chat-time {
  font-size: 12px;
  color: var(--text-light);
  margin-bottom: 4px;
}

.chat-unread {
  background: var(--primary);
  color: white;
  font-size: 12px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Chat Window */
.chat-window {
  display: none;
  background: var(--white);
  border-radius: var(--radius);
  height: 600px;
  flex-direction: column;
  box-shadow: var(--shadow);
}

.chat-window.active {
  display: flex;
}

.chat-header {
  padding: 16px;
  border-bottom: 1px solid var(--soft);
  display: flex;
  align-items: center;
  gap: 12px;
}

.chat-back {
  cursor: pointer;
  display: none;
}

.chat-messages {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.message {
  max-width: 70%;
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
  animation: messageIn 0.3s ease;
}

@keyframes messageIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.message.sent {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  align-self: flex-end;
  border-bottom-right-radius: 4px;
}

.message.received {
  background: var(--soft);
  align-self: flex-start;
  border-bottom-left-radius: 4px;
}

.message-time {
  font-size: 11px;
  opacity: 0.7;
  margin-top: 4px;
  text-align: right;
}

.chat-input-container {
  padding: 16px;
  border-top: 1px solid var(--soft);
  display: flex;
  gap: 12px;
}

.chat-input {
  flex: 1;
  padding: 12px 16px;
  border: 1px solid var(--soft-dark);
  border-radius: 24px;
  font-size: 16px;
}

.chat-send {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ========== PROFILE PAGE ========== */
.profile-container {
  background: var(--white);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.profile-header {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  padding: 30px 20px;
  color: white;
  text-align: center;
  position: relative;
}

.profile-avatar {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 15px;
  color: var(--primary);
  font-size: 40px;
  font-weight: bold;
  border: 4px solid white;
}

.profile-name {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 8px;
}

.profile-title {
  font-size: 16px;
  opacity: 0.9;
}

.profile-edit-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.profile-stats {
  display: flex;
  justify-content: space-around;
  padding: 20px;
  border-bottom: 1px solid var(--soft);
}

.stat {
  text-align: center;
}

.stat-value {
  font-size: 24px;
  font-weight: 700;
  color: var(--dark);
}

.stat-label {
  font-size: 14px;
  color: var(--text-light);
}

.profile-content {
  padding: 20px;
}

.section-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--dark);
}

/* ========== SEARCH PAGE ========== */
.search-container {
  background: var(--white);
  border-radius: var(--radius);
  padding: 20px;
  box-shadow: var(--shadow);
}

.search-bar {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
}

.search-input {
  flex: 1;
  padding: 14px 20px;
  border: 1px solid var(--soft-dark);
  border-radius: 50px;
  font-size: 16px;
}

.search-categories {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  overflow-x: auto;
  padding-bottom: 10px;
}

.search-category {
  padding: 8px 16px;
  background: var(--soft);
  border-radius: 50px;
  font-size: 14px;
  white-space: nowrap;
  cursor: pointer;
  transition: var(--transition);
}

.search-category.active {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
}

/* ========== MODALS ========== */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
}

.modal.active {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  background: var(--white);
  border-radius: var(--radius);
  padding: 30px;
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  transform: translateY(20px);
  transition: var(--transition);
}

.modal.active .modal-content {
  transform: translateY(0);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.modal-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text-light);
}

/* ========== SKELETON LOADERS ========== */
.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: var(--radius-sm);
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.skeleton-text {
  height: 12px;
  margin-bottom: 8px;
}

.skeleton-avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
}

/* ========== GLOBAL SELECTORS ========== */
.global-selectors {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.selector {
  flex: 1;
  min-width: 150px;
}

.selector select {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid var(--soft-dark);
  border-radius: var(--radius-sm);
  font-size: 16px;
  background: var(--white);
}

/* ========== SIDEBAR ========== */
.sidebar {
  position: fixed;
  top: 64px;
  left: -300px;
  width: 280px;
  height: calc(100vh - 64px);
  background: var(--dark);
  color: white;
  overflow-y: auto;
  transition: var(--transition);
  z-index: 99;
  padding: 20px 0;
}

.sidebar.active {
  left: 0;
}

.sidebar-section {
  margin-bottom: 25px;
  padding: 0 20px;
}

.sidebar-title {
  font-size: 12px;
  color: #94a3b8;
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: var(--transition);
  margin-bottom: 5px;
}

.sidebar-item:hover {
  background: var(--dark-light);
}

.sidebar-item .material-icons {
  font-size: 20px;
}

/* ========== BUSINESS/MARKETPLACE ========== */
.marketplace-feed {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.product-card {
  background: var(--white);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: var(--transition);
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.product-image {
  height: 180px;
  background: var(--soft);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-light);
}

.product-info {
  padding: 20px;
}

.product-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 8px;
}

.product-price {
  color: var(--primary);
  font-size: 22px;
  font-weight: 700;
  margin-bottom: 12px;
}

.product-fees {
  font-size: 14px;
  color: var(--text-light);
  margin-bottom: 16px;
}

.product-fees span {
  display: block;
  margin-bottom: 4px;
}

.product-buy {
  width: 100%;
  padding: 12px;
  background: linear-gradient(135deg, var(--success), #059669);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  font-weight: 600;
  cursor: pointer;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 768px) {
  .auth-links {
    flex-direction: column;
    gap: 10px;
  }
  
  .header-left h1 {
    font-size: 18px;
  }
  
  .chat-back {
    display: block;
  }
  
  .marketplace-feed {
    grid-template-columns: 1fr;
  }
  
  .global-selectors {
    flex-direction: column;
  }
  
  .selector {
    min-width: 100%;
  }
  
  .search-bar {
    flex-direction: column;
  }
}

@media (min-width: 769px) {
  .sidebar {
    left: 0;
  }
  
  main {
    margin-left: 280px;
    max-width: calc(100% - 280px);
  }
  
  .bottom-nav {
    display: none;
  }
}

/* Utility classes */
.hidden {
  display: none !important;
}

.text-center {
  text-align: center;
}

.mb-1 { margin-bottom: 8px; }
.mb-2 { margin-bottom: 16px; }
.mb-3 { margin-bottom: 24px; }
.mb-4 { margin-bottom: 32px; }

.p-1 { padding: 8px; }
.p-2 { padding: 16px; }
.p-3 { padding: 24px; }
.p-4 { padding: 32px; }
</style>
</head>
<body>

<!-- ================= AUTHENTICATION SCREEN ================= -->
<div id="auth">
  <h2>Welcome to LamEarn üåç</h2>
  <p class="text-center mb-3" style="color: var(--text-light)">Your global work & marketplace platform</p>
  
  <div class="auth-input-group">
    <span class="material-icons">email</span>
    <input id="email" type="email" placeholder="Email address" autocomplete="email">
  </div>
  
  <div class="auth-input-group">
    <span class="material-icons">lock</span>
    <input id="password" type="password" placeholder="Password (8+ characters)" autocomplete="current-password">
    <button class="password-toggle" id="togglePassword" type="button">
      <span class="material-icons">visibility_off</span>
    </button>
  </div>
  
  <button id="loginBtn" onclick="login()">Continue</button>
  
  <button class="google-btn" onclick="googleLogin()">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
    Continue with Google
  </button>
  
  <div class="auth-links">
    <span onclick="showRegister()">Create new account</span>
    <span onclick="resetPassword()">Forgot password?</span>
  </div>
</div>

<!-- ================= DASHBOARD ================= -->
<div id="dashboard">
  <!-- Header -->
  <header>
    <div class="header-left">
      <span class="material-icons" onclick="toggleSidebar()">menu</span>
      <h1>LamEarn</h1>
    </div>
    <div class="header-right">
      <span class="material-icons" onclick="showGlobalSettings()">language</span>
      <span class="material-icons" onclick="showNotifications()">notifications</span>
      <span class="material-icons" onclick="logout()">logout</span>
    </div>
  </header>
  
  <!-- Sidebar Menu -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">Core</div>
      <div class="sidebar-item" onclick="showPage('home')">
        <span class="material-icons">dashboard</span> Dashboard
      </div>
      <div class="sidebar-item" onclick="showPage('explore')">
        <span class="material-icons">public</span> Explore
      </div>
      <div class="sidebar-item" onclick="showPage('search')">
        <span class="material-icons">search</span> Search
      </div>
    </div>
    
    <div class="sidebar-section">
      <div class="sidebar-title">Work & Earn</div>
      <div class="sidebar-item" onclick="showPage('jobs')">
        <span class="material-icons">work</span> Jobs
      </div>
      <div class="sidebar-item" onclick="showPage('tasks')">
        <span class="material-icons">task_alt</span> Tasks
      </div>
      <div class="sidebar-item" onclick="showPage('contracts')">
        <span class="material-icons">assignment</span> Contracts
      </div>
    </div>
    
    <div class="sidebar-section">
      <div class="sidebar-title">Marketplace</div>
      <div class="sidebar-item" onclick="showPage('marketplace')">
        <span class="material-icons">store</span> Products
      </div>
      <div class="sidebar-item" onclick="showPage('designs')">
        <span class="material-icons">brush</span> Designs
      </div>
      <div class="sidebar-item" onclick="showPage('code')">
        <span class="material-icons">code</span> Code
      </div>
      <div class="sidebar-item" onclick="showPage('courses')">
        <span class="material-icons">menu_book</span> Courses
      </div>
    </div>
    
    <div class="sidebar-section">
      <div class="sidebar-title">Social</div>
      <div class="sidebar-item" onclick="showPage('inbox')">
        <span class="material-icons">chat</span> Inbox
      </div>
      <div class="sidebar-item" onclick="showPage('community')">
        <span class="material-icons">groups</span> Community
      </div>
    </div>
    
    <div class="sidebar-section">
      <div class="sidebar-title">Wallet</div>
      <div class="sidebar-item" onclick="showPage('wallet')">
        <span class="material-icons">account_balance_wallet</span> Wallet
      </div>
      <div class="sidebar-item" onclick="showPage('exchange')">
        <span class="material-icons">currency_exchange</span> Exchange
      </div>
    </div>
    
    <div class="sidebar-section">
      <div class="sidebar-title">Account</div>
      <div class="sidebar-item" onclick="showPage('profile')">
        <span class="material-icons">person</span> Profile
      </div>
      <div class="sidebar-item" onclick="showPage('settings')">
        <span class="material-icons">settings</span> Settings
      </div>
    </div>
  </aside>
  
  <!-- Main Content -->
  <main>
    <!-- Home Page (Social Feed) -->
    <div id="home-page" class="page active">
      <div class="feed" id="social-feed">
        <!-- Posts will be loaded here -->
        <div class="skeleton post">
          <div class="post-header">
            <div class="skeleton skeleton-avatar"></div>
            <div style="flex:1">
              <div class="skeleton skeleton-text" style="width:60%"></div>
              <div class="skeleton skeleton-text" style="width:40%"></div>
            </div>
          </div>
          <div class="post-content">
            <div class="skeleton skeleton-text"></div>
            <div class="skeleton skeleton-text"></div>
            <div class="skeleton skeleton-text" style="width:80%"></div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Search Page -->
    <div id="search-page" class="page">
      <div class="search-container">
        <div class="search-bar">
          <input type="text" class="search-input" placeholder="Search jobs, products, people..." id="searchInput">
          <button onclick="performSearch()">
            <span class="material-icons">search</span>
          </button>
        </div>
        <div class="search-categories">
          <div class="search-category active">All</div>
          <div class="search-category">Jobs</div>
          <div class="search-category">Products</div>
          <div class="search-category">People</div>
          <div class="search-category">Services</div>
          <div class="search-category">Courses</div>
        </div>
        <div id="search-results"></div>
      </div>
    </div>
    
    <!-- Upload Page -->
    <div id="upload-page" class="page">
      <div class="upload-container">
        <div class="upload-header">
          <span class="material-icons" style="font-size:32px; color:var(--primary)">cloud_upload</span>
          <h2>Create Post</h2>
        </div>
        
        <div class="upload-type-selector">
          <div class="upload-type active" data-type="text">Text</div>
          <div class="upload-type" data-type="image">Image</div>
          <div class="upload-type" data-type="video">Video</div>
          <div class="upload-type" data-type="business">Business</div>
        </div>
        
        <div class="upload-preview" id="uploadPreview">
          <div class="upload-preview-placeholder">
            <span class="material-icons" style="font-size:48px; color:var(--text-light)">add_photo_alternate</span>
            <p>Select an image or video to preview</p>
          </div>
        </div>
        
        <input type="text" id="postTitle" placeholder="Post title (optional)" class="mb-2">
        <textarea id="postContent" placeholder="What's on your mind?" rows="4" class="mb-2"></textarea>
        
        <input type="file" id="mediaUpload" accept="image/*,video/*" class="mb-2" style="display:none">
        
        <div id="businessFields" style="display:none">
          <input type="number" id="productPrice" placeholder="Price ($)" class="mb-2">
          <select id="productCurrency" class="mb-2">
            <option value="USD">USD ($)</option>
            <option value="EUR">EUR (‚Ç¨)</option>
            <option value="GBP">GBP (¬£)</option>
            <option value="JPY">JPY (¬•)</option>
          </select>
          <input type="text" id="productCategory" placeholder="Category" class="mb-2">
        </div>
        
        <button onclick="createPost()">Publish Post</button>
      </div>
    </div>
    
    <!-- Inbox Page -->
    <div id="inbox-page" class="page">
      <div class="inbox-container">
        <div class="inbox-header">
          <h2>Messages</h2>
          <button style="width:auto; padding:8px 16px" onclick="startNewChat()">
            <span class="material-icons">add</span> New
          </button>
        </div>
        <div class="chat-list" id="chatList">
          <!-- Chats will be loaded here -->
        </div>
      </div>
      
      <!-- Chat Window -->
      <div class="chat-window" id="chatWindow">
        <div class="chat-header">
          <span class="material-icons chat-back" onclick="closeChat()">arrow_back</span>
          <div class="chat-avatar" id="chatAvatar">JD</div>
          <div class="chat-info">
            <div class="chat-name" id="chatName">John Doe</div>
            <div class="chat-last-seen" id="chatLastSeen">Online</div>
          </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
          <!-- Messages will be loaded here -->
          <div class="message received">
            Hello! How can I help you today?
            <div class="message-time">10:30 AM</div>
          </div>
          <div class="message sent">
            I'm interested in your web design service
            <div class="message-time">10:32 AM</div>
          </div>
        </div>
        
        <div class="chat-input-container">
          <input type="text" class="chat-input" id="chatInput" placeholder="Type a message...">
          <button class="chat-send" onclick="sendMessage()">
            <span class="material-icons">send</span>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Profile Page -->
    <div id="profile-page" class="page">
      <div class="profile-container">
        <div class="profile-header">
          <button class="profile-edit-btn" onclick="editProfile()">
            <span class="material-icons">edit</span>
          </button>
          <div class="profile-avatar" id="profileAvatar">JD</div>
          <div class="profile-name" id="profileName">John Doe</div>
          <div class="profile-title" id="profileTitle">Web Developer</div>
        </div>
        
        <div class="profile-stats">
          <div class="stat">
            <div class="stat-value" id="postCount">24</div>
            <div class="stat-label">Posts</div>
          </div>
          <div class="stat">
            <div class="stat-value" id="followersCount">128</div>
            <div class="stat-label">Followers</div>
          </div>
          <div class="stat">
            <div class="stat-value" id="followingCount">56</div>
            <div class="stat-label">Following</div>
          </div>
        </div>
        
        <div class="profile-content">
          <div class="section-title">About</div>
          <p id="profileAbout">Full-stack developer with 5+ years of experience. Specialized in React, Node.js, and Firebase.</p>
          
          <div class="section-title">Skills</div>
          <div id="profileSkills">
            <span style="display:inline-block; background:var(--soft); padding:6px 12px; border-radius:50px; margin:4px">JavaScript</span>
            <span style="display:inline-block; background:var(--soft); padding:6px 12px; border-radius:50px; margin:4px">React</span>
            <span style="display:inline-block; background:var(--soft); padding:6px 12px; border-radius:50px; margin:4px">Node.js</span>
            <span style="display:inline-block; background:var(--soft); padding:6px 12px; border-radius:50px; margin:4px">Firebase</span>
          </div>
          
          <div class="section-title">Recent Activity</div>
          <div id="recentActivity">
            <!-- Activity will be loaded here -->
          </div>
        </div>
      </div>
    </div>
    
    <!-- Marketplace Page -->
    <div id="marketplace-page" class="page">
      <div class="global-selectors">
        <div class="selector">
          <select id="marketplaceCategory">
            <option value="all">All Categories</option>
            <option value="digital">Digital Products</option>
            <option value="services">Services</option>
            <option value="freelance">Freelance Gigs</option>
            <option value="courses">Courses</option>
          </select>
        </div>
        <div class="selector">
          <select id="marketplaceCurrency">
            <option value="USD">USD ($)</option>
            <option value="EUR">EUR (‚Ç¨)</option>
            <option value="GBP">GBP (¬£)</option>
            <option value="CAD">CAD (C$)</option>
            <option value="AUD">AUD (A$)</option>
            <option value="JPY">JPY (¬•)</option>
            <option value="CNY">CNY (¬•)</option>
            <option value="INR">INR (‚Çπ)</option>
          </select>
        </div>
        <div class="selector">
          <select id="marketplaceSort">
            <option value="newest">Newest</option>
            <option value="price-low">Price: Low to High</option>
            <option value="price-high">Price: High to Low</option>
            <option value="popular">Most Popular</option>
          </select>
        </div>
      </div>
      
      <div class="marketplace-feed" id="marketplaceFeed">
        <!-- Products will be loaded here -->
      </div>
    </div>
  </main>
  
  <!-- Bottom Navigation (Mobile Only) -->
  <div class="bottom-nav">
    <div class="nav-item active" onclick="showPage('home')">
      <span class="material-icons">home</span>
      <span>Home</span>
    </div>
    <div class="nav-item" onclick="showPage('search')">
      <span class="material-icons">search</span>
      <span>Search</span>
    </div>
    <div class="nav-item" onclick="showPage('upload')">
      <span class="material-icons">add_circle</span>
      <span>Upload</span>
    </div>
    <div class="nav-item" onclick="showPage('inbox')">
      <span class="material-icons">chat</span>
      <span>Inbox</span>
    </div>
    <div class="nav-item" onclick="showPage('profile')">
      <span class="material-icons">person</span>
      <span>Profile</span>
    </div>
  </div>
</div>

<!-- ================= MODALS ================= -->
<!-- Global Settings Modal -->
<div class="modal" id="globalModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Global Settings</h2>
      <button class="modal-close" onclick="closeModal('globalModal')">√ó</button>
    </div>
    
    <div class="selector mb-3">
      <label>Language</label>
      <select id="languageSelect">
        <option value="en">English</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="zh">Chinese</option>
        <option value="ja">Japanese</option>
        <option value="ar">Arabic</option>
        <option value="hi">Hindi</option>
        <option value="pt">Portuguese</option>
        <option value="ru">Russian</option>
      </select>
    </div>
    
    <div class="selector mb-3">
      <label>Currency</label>
      <select id="currencySelect">
        <option value="USD">US Dollar ($)</option>
        <option value="EUR">Euro (‚Ç¨)</option>
        <option value="GBP">British Pound (¬£)</option>
        <option value="JPY">Japanese Yen (¬•)</option>
        <option value="CAD">Canadian Dollar (C$)</option>
        <option value="AUD">Australian Dollar (A$)</option>
        <option value="CNY">Chinese Yuan (¬•)</option>
        <option value="INR">Indian Rupee (‚Çπ)</option>
      </select>
    </div>
    
    <div class="selector mb-3">
      <label>Timezone</label>
      <select id="timezoneSelect">
        <option value="UTC-5">EST (UTC-5)</option>
        <option value="UTC-8">PST (UTC-8)</option>
        <option value="UTC+0">GMT (UTC+0)</option>
        <option value="UTC+1">CET (UTC+1)</option>
        <option value="UTC+8">CST (UTC+8)</option>
        <option value="UTC+5:30">IST (UTC+5:30)</option>
      </select>
    </div>
    
    <button onclick="saveGlobalSettings()">Save Settings</button>
  </div>
</div>

<!-- Post Detail Modal -->
<div class="modal" id="postModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Post Details</h2>
      <button class="modal-close" onclick="closeModal('postModal')">√ó</button>
    </div>
    <div id="postModalContent"></div>
  </div>
</div>

<!-- ================= FIREBASE & APP CODE ================= -->
<script>
// Firebase Configuration - DO NOT CHANGE
const firebaseConfig = {
  apiKey: "AIzaSyCZEWX2On7HXmGeOJwpkTW7v7KFTQaVsTI",
  authDomain: "worklink-global-2d54e.firebaseapp.com",
  projectId: "worklink-global-2d54e",
  storageBucket: "worklink-global-2d54e.firebasestorage.app",
  messagingSenderId: "935048390740",
  appId: "1:935048390740:web:a365157b9242efb14465c1",
  measurementId: "G-EMC1Z7FTH0"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

// Current User Data
let currentUser = null;
let currentPage = 'home';

// ========== AUTHENTICATION FUNCTIONS ==========
// Toggle password visibility
document.getElementById('togglePassword').addEventListener('click', function() {
  const passwordInput = document.getElementById('password');
  const icon = this.querySelector('.material-icons');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    icon.textContent = 'visibility';
  } else {
    passwordInput.type = 'password';
    icon.textContent = 'visibility_off';
  }
});

// Ripple effect for buttons
document.addEventListener('click', function(e) {
  if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
    const button = e.target.tagName === 'BUTTON' ? e.target : e.target.closest('button');
    const ripple = document.createElement('span');
    const rect = button.getBoundingClientRect();
    const size = Math.max(rect.width, rect.height);
    const x = e.clientX - rect.left - size / 2;
    const y = e.clientY - rect.top - size / 2;
    
    ripple.style.width = ripple.style.height = size + 'px';
    ripple.style.left = x + 'px';
    ripple.style.top = y + 'px';
    ripple.classList.add('ripple');
    
    button.appendChild(ripple);
    setTimeout(() => ripple.remove(), 600);
  }
});

// Login function
function login() {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const loginBtn = document.getElementById('loginBtn');
  
  if (!email || !password) {
    alert('Please enter both email and password');
    return;
  }
  
  loginBtn.innerHTML = 'Logging in...';
  loginBtn.disabled = true;
  
  auth.signInWithEmailAndPassword(email, password)
    .then((userCredential) => {
      // Success - handled by onAuthStateChanged
    })
    .catch((error) => {
      loginBtn.innerHTML = 'Continue';
      loginBtn.disabled = false;
      alert(error.message);
    });
}

// Register function
function showRegister() {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  
  if (!email || !password) {
    alert('Please enter both email and password');
    return;
  }
  
  if (password.length < 8) {
    alert('Password must be at least 8 characters');
    return;
  }
  
  auth.createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
      // Create user document in Firestore
      return db.collection('users').doc(userCredential.user.uid).set({
        email: email,
        name: email.split('@')[0],
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        profileComplete: false
      });
    })
    .catch((error) => {
      alert(error.message);
    });
}

// Google login
function googleLogin() {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider)
    .then((result) => {
      // Check if user exists in Firestore
      const userRef = db.collection('users').doc(result.user.uid);
      userRef.get().then((doc) => {
        if (!doc.exists) {
          // Create new user document
          userRef.set({
            email: result.user.email,
            name: result.user.displayName || result.user.email.split('@')[0],
            photoURL: result.user.photoURL,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            profileComplete: false
          });
        }
      });
    })
    .catch((error) => {
      alert(error.message);
    });
}

// Reset password
function resetPassword() {
  const email = document.getElementById('email').value;
  
  if (!email) {
    alert('Please enter your email address');
    return;
  }
  
  auth.sendPasswordResetEmail(email)
    .then(() => {
      alert('Password reset email sent. Check your inbox.');
    })
    .catch((error) => {
      alert(error.message);
    });
}

// Logout
function logout() {
  if (confirm('Are you sure you want to logout?')) {
    auth.signOut();
  }
}

// Auth state observer
auth.onAuthStateChanged((user) => {
  if (user) {
    currentUser = user;
    document.getElementById('auth').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    
    // Load user data
    loadUserData(user.uid);
    
    // Load initial page
    showPage('home');
  } else {
    currentUser = null;
    document.getElementById('auth').style.display = 'block';
    document.getElementById('dashboard').style.display = 'none';
  }
});

// ========== NAVIGATION FUNCTIONS ==========
// Toggle sidebar
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('active');
}

// Show page
function showPage(page) {
  // Update current page
  currentPage = page;
  
  // Hide all pages
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  
  // Show selected page
  document.getElementById(`${page}-page`).classList.add('active');
  
  // Update bottom nav
  document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
  document.querySelector(`.nav-item[onclick="showPage('${page}')"]`)?.classList.add('active');
  
  // Close sidebar on mobile
  if (window.innerWidth <= 768) {
    document.getElementById('sidebar').classList.remove('active');
  }
  
  // Load page data
  switch(page) {
    case 'home':
      loadSocialFeed();
      break;
    case 'inbox':
      loadChatList();
      break;
    case 'marketplace':
      loadMarketplace();
      break;
    case 'profile':
      loadProfile();
      break;
  }
}

// ========== POSTS & SOCIAL FEED ==========
// Create a new post
function createPost() {
  if (!currentUser) return;
  
  const title = document.getElementById('postTitle').value;
  const content = document.getElementById('postContent').value;
  const mediaFile = document.getElementById('mediaUpload').files[0];
  const postType = document.querySelector('.upload-type.active').dataset.type;
  
  if (!content.trim() && !mediaFile) {
    alert('Please add some content or media');
    return;
  }
  
  const postData = {
    userId: currentUser.uid,
    userName: currentUser.displayName || currentUser.email.split('@')[0],
    title: title,
    content: content,
    type: postType,
    likes: 0,
    comments: 0,
    shares: 0,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  };
  
  // Add business data if business post
  if (postType === 'business') {
    postData.price = parseFloat(document.getElementById('productPrice').value) || 0;
    postData.currency = document.getElementById('productCurrency').value;
    postData.category = document.getElementById('productCategory').value;
  }
  
  // Upload media if exists
  if (mediaFile) {
    const storageRef = storage.ref(`posts/${currentUser.uid}/${Date.now()}_${mediaFile.name}`);
    storageRef.put(mediaFile)
      .then(snapshot => snapshot.ref.getDownloadURL())
      .then(url => {
        postData.mediaURL = url;
        postData.mediaType = mediaFile.type.startsWith('image/') ? 'image' : 'video';
        savePostToFirestore(postData);
      })
      .catch(error => {
        console.error('Media upload error:', error);
        savePostToFirestore(postData);
      });
  } else {
    savePostToFirestore(postData);
  }
}

// Save post to Firestore
function savePostToFirestore(postData) {
  db.collection('posts').add(postData)
    .then(() => {
      alert('Post published successfully!');
      document.getElementById('postTitle').value = '';
      document.getElementById('postContent').value = '';
      document.getElementById('mediaUpload').value = '';
      document.getElementById('uploadPreview').innerHTML = `
        <div class="upload-preview-placeholder">
          <span class="material-icons" style="font-size:48px; color:var(--text-light)">add_photo_alternate</span>
          <p>Select an image or video to preview</p>
        </div>
      `;
      showPage('home');
    })
    .catch(error => {
      alert('Error publishing post: ' + error.message);
    });
}

// Load social feed
function loadSocialFeed() {
  const feedContainer = document.getElementById('social-feed');
  feedContainer.innerHTML = `
    <div class="skeleton post">
      <div class="post-header">
        <div class="skeleton skeleton-avatar"></div>
        <div style="flex:1">
          <div class="skeleton skeleton-text" style="width:60%"></div>
          <div class="skeleton skeleton-text" style="width:40%"></div>
        </div>
      </div>
      <div class="post-content">
        <div class="skeleton skeleton-text"></div>
        <div class="skeleton skeleton-text"></div>
        <div class="skeleton skeleton-text" style="width:80%"></div>
      </div>
    </div>
  `;
  
  // Load posts from Firestore
  db.collection('posts')
    .orderBy('createdAt', 'desc')
    .limit(10)
    .get()
    .then(snapshot => {
      feedContainer.innerHTML = '';
      
      if (snapshot.empty) {
        feedContainer.innerHTML = `
          <div class="card text-center p-4">
            <span class="material-icons" style="font-size:48px; color:var(--text-light)">feed</span>
            <h3>No posts yet</h3>
            <p>Be the first to share something!</p>
            <button onclick="showPage('upload')" style="width:auto; margin-top:16px">Create Post</button>
          </div>
        `;
        return;
      }
      
      snapshot.forEach(doc => {
        const post = doc.data();
        const postId = doc.id;
        const postDate = post.createdAt ? post.createdAt.toDate().toLocaleDateString() : 'Recently';
        
        const postElement = document.createElement('div');
        postElement.className = 'post';
        postElement.innerHTML = `
          <div class="post-header">
            <div class="post-avatar">${post.userName ? post.userName.charAt(0).toUpperCase() : 'U'}</div>
            <div class="post-user">
              <div class="post-user-name">${post.userName || 'User'}</div>
              <div class="post-time">${postDate}</div>
            </div>
            <span class="material-icons post-options">more_vert</span>
          </div>
          <div class="post-content">
            ${post.title ? `<h3>${post.title}</h3>` : ''}
            <div class="post-text">${post.content || ''}</div>
            ${post.mediaURL ? `
              <div class="post-media">
                ${post.mediaType === 'image' 
                  ? `<img src="${post.mediaURL}" alt="Post image" onerror="this.style.display='none'">`
                  : `<video controls><source src="${post.mediaURL}" type="video/mp4"></video>`
                }
              </div>
            ` : ''}
            ${post.price ? `
              <div style="background:var(--soft); padding:12px; border-radius:var(--radius-sm); margin-top:12px">
                <strong>Price:</strong> ${post.currency || '$'}${post.price.toFixed(2)}
                ${post.category ? `<br><strong>Category:</strong> ${post.category}` : ''}
              </div>
            ` : ''}
          </div>
          <div class="post-stats">
            <span>${post.likes || 0} likes</span>
            <span>${post.comments || 0} comments</span>
            <span>${post.shares || 0} shares</span>
          </div>
          <div class="post-actions">
            <div class="post-action" onclick="likePost('${postId}')">
              <span class="material-icons">thumb_up</span>
              <span>Like</span>
            </div>
            <div class="post-action" onclick="commentOnPost('${postId}')">
              <span class="material-icons">comment</span>
              <span>Comment</span>
            </div>
            <div class="post-action" onclick="sharePost('${postId}')">
              <span class="material-icons">share</span>
              <span>Share</span>
            </div>
            <div class="post-action" onclick="savePost('${postId}')">
              <span class="material-icons">bookmark</span>
              <span>Save</span>
            </div>
          </div>
        `;
        
        feedContainer.appendChild(postElement);
      });
    })
    .catch(error => {
      console.error('Error loading posts:', error);
      feedContainer.innerHTML = `<div class="card">Error loading posts. Please try again.</div>`;
    });
}

// ========== CHAT FUNCTIONS ==========
// Load chat list
function loadChatList() {
  const chatList = document.getElementById('chatList');
  chatList.innerHTML = `
    <div class="chat-item">
      <div class="skeleton skeleton-avatar"></div>
      <div style="flex:1">
        <div class="skeleton skeleton-text" style="width:70%"></div>
        <div class="skeleton skeleton-text" style="width:50%"></div>
      </div>
    </div>
  `;
  
  // In a real app, you would load chats from Firestore
  setTimeout(() => {
    chatList.innerHTML = `
      <div class="chat-item" onclick="openChat('user1', 'Alex Johnson', 'AJ')">
        <div class="chat-avatar">AJ</div>
        <div class="chat-info">
          <div class="chat-name">Alex Johnson</div>
          <div class="chat-last-message">Hey, are you available for a project?</div>
        </div>
        <div class="chat-meta">
          <div class="chat-time">2 min ago</div>
          <div class="chat-unread">3</div>
        </div>
      </div>
      <div class="chat-item" onclick="openChat('user2', 'Maria Garcia', 'MG')">
        <div class="chat-avatar">MG</div>
        <div class="chat-info">
          <div class="chat-name">Maria Garcia</div>
          <div class="chat-last-message">I sent you the design files</div>
        </div>
        <div class="chat-meta">
          <div class="chat-time">1 hour ago</div>
        </div>
      </div>
      <div class="chat-item" onclick="openChat('user3', 'David Smith', 'DS')">
        <div class="chat-avatar">DS</div>
        <div class="chat-info">
          <div class="chat-name">David Smith</div>
          <div class="chat-last-message">Thanks for your help!</div>
        </div>
        <div class="chat-meta">
          <div class="chat-time">Yesterday</div>
        </div>
      </div>
    `;
  }, 500);
}

// Open chat
function openChat(userId, userName, userInitials) {
  document.getElementById('chatAvatar').textContent = userInitials;
  document.getElementById('chatName').textContent = userName;
  
  document.querySelector('.inbox-container').style.display = 'none';
  document.getElementById('chatWindow').classList.add('active');
  
  if (window.innerWidth <= 768) {
    document.querySelector('.chat-back').style.display = 'block';
  }
}

// Close chat
function closeChat() {
  document.querySelector('.inbox-container').style.display = 'block';
  document.getElementById('chatWindow').classList.remove('active');
}

// Send message
function sendMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  
  if (!message || !currentUser) return;
  
  const chatMessages = document.getElementById('chatMessages');
  const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
  
  const messageElement = document.createElement('div');
  messageElement.className = 'message sent';
  messageElement.innerHTML = `
    ${message}
    <div class="message-time">${time}</div>
  `;
  
  chatMessages.appendChild(messageElement);
  input.value = '';
  chatMessages.scrollTop = chatMessages.scrollHeight;
  
  // In a real app, save to Firestore
  // db.collection('chats').doc(chatId).collection('messages').add(...)
}

// ========== MARKETPLACE ==========
// Load marketplace
function loadMarketplace() {
  const feed = document.getElementById('marketplaceFeed');
  feed.innerHTML = `
    <div class="skeleton product-card">
      <div class="skeleton" style="height:180px"></div>
      <div class="p-3">
        <div class="skeleton skeleton-text"></div>
        <div class="skeleton skeleton-text" style="width:60%"></div>
      </div>
    </div>
  `;
  
  // In a real app, load from Firestore
  setTimeout(() => {
    feed.innerHTML = `
      <div class="product-card">
        <div class="product-image">
          <span class="material-icons" style="font-size:48px; color:var(--text-light)">code</span>
        </div>
        <div class="product-info">
          <div class="product-title">Website Development</div>
          <div class="product-price">$499.99</div>
          <div class="product-fees">
            <span>Platform fee: $50.00</span>
            <span>Service fee: $25.00</span>
            <span>Total: $574.99</span>
          </div>
          <button class="product-buy">Buy Now</button>
        </div>
      </div>
      <div class="product-card">
        <div class="product-image">
          <span class="material-icons" style="font-size:48px; color:var(--text-light)">brush</span>
        </div>
        <div class="product-info">
          <div class="product-title">Logo Design Package</div>
          <div class="product-price">$149.99</div>
          <div class="product-fees">
            <span>Platform fee: $15.00</span>
            <span>Service fee: $7.50</span>
            <span>Total: $172.49</span>
          </div>
          <button class="product-buy">Buy Now</button>
        </div>
      </div>
      <div class="product-card">
        <div class="product-image">
          <span class="material-icons" style="font-size:48px; color:var(--text-light)">menu_book</span>
        </div>
        <div class="product-info">
          <div class="product-title">React JS Course</div>
          <div class="product-price">$89.99</div>
          <div class="product-fees">
            <span>Platform fee: $9.00</span>
            <span>Service fee: $4.50</span>
            <span>Total: $103.49</span>
          </div>
          <button class="product-buy">Buy Now</button>
        </div>
      </div>
    `;
  }, 500);
}

// ========== PROFILE FUNCTIONS ==========
// Load user data
function loadUserData(userId) {
  db.collection('users').doc(userId).get()
    .then(doc => {
      if (doc.exists) {
        const userData = doc.data();
        updateProfileUI(userData);
      }
    })
    .catch(error => {
      console.error('Error loading user data:', error);
    });
}

// Update profile UI
function updateProfileUI(userData) {
  if (userData.name) {
    document.getElementById('profileName').textContent = userData.name;
    document.getElementById('profileAvatar').textContent = userData.name.charAt(0).toUpperCase();
  }
  
  if (userData.title) {
    document.getElementById('profileTitle').textContent = userData.title;
  }
  
  if (userData.about) {
    document.getElementById('profileAbout').textContent = userData.about;
  }
  
  if (userData.skills) {
    const skillsContainer = document.getElementById('profileSkills');
    skillsContainer.innerHTML = '';
    userData.skills.forEach(skill => {
      const skillElement = document.createElement('span');
      skillElement.style.cssText = 'display:inline-block; background:var(--soft); padding:6px 12px; border-radius:50px; margin:4px';
      skillElement.textContent = skill;
      skillsContainer.appendChild(skillElement);
    });
  }
}

// Load profile
function loadProfile() {
  if (currentUser) {
    loadUserData(currentUser.uid);
  }
}

// Edit profile
function editProfile() {
  const name = prompt('Enter your name:', document.getElementById('profileName').textContent);
  const title = prompt('Enter your title:', document.getElementById('profileTitle').textContent);
  const about = prompt('Enter about text:', document.getElementById('profileAbout').textContent);
  
  if (name || title || about) {
    const updates = {};
    if (name) updates.name = name;
    if (title) updates.title = title;
    if (about) updates.about = about;
    
    db.collection('users').doc(currentUser.uid).update(updates)
      .then(() => {
        loadUserData(currentUser.uid);
        alert('Profile updated successfully!');
      })
      .catch(error => {
        alert('Error updating profile: ' + error.message);
      });
  }
}

// ========== UTILITY FUNCTIONS ==========
// Show modal
function showModal(modalId) {
  document.getElementById(modalId).classList.add('active');
}

// Close modal
function closeModal(modalId) {
  document.getElementById(modalId).classList.remove('active');
}

// Show global settings
function showGlobalSettings() {
  showModal('globalModal');
}

// Save global settings
function saveGlobalSettings() {
  const language = document.getElementById('languageSelect').value;
  const currency = document.getElementById('currencySelect').value;
  const timezone = document.getElementById('timezoneSelect').value;
  
  if (currentUser) {
    db.collection('users').doc(currentUser.uid).update({
      language: language,
      currency: currency,
      timezone: timezone,
      settingsUpdatedAt: firebase.firestore.FieldValue.serverTimestamp()
    })
    .then(() => {
      alert('Settings saved successfully!');
      closeModal('globalModal');
    })
    .catch(error => {
      alert('Error saving settings: ' + error.message);
    });
  } else {
    alert('Please login to save settings');
  }
}

// Perform search
function performSearch() {
  const query = document.getElementById('searchInput').value;
  if (!query.trim()) return;
  
  const resultsDiv = document.getElementById('search-results');
  resultsDiv.innerHTML = `<div class="card text-center p-4">Searching for "${query}"...</div>`;
  
  // In a real app, search Firestore
  setTimeout(() => {
    resultsDiv.innerHTML = `
      <div class="card mb-2">
        <h3>Web Developer</h3>
        <p>Looking for a React developer for a 3-month project.</p>
        <small>Posted 2 days ago</small>
      </div>
      <div class="card mb-2">
        <h3>Logo Design</h3>
        <p>Professional logo design for a tech startup.</p>
        <small>Price: $199</small>
      </div>
    `;
  }, 1000);
}

// Initialize upload type selector
document.addEventListener('DOMContentLoaded', function() {
  // Upload type selection
  document.querySelectorAll('.upload-type').forEach(type => {
    type.addEventListener('click', function() {
      document.querySelectorAll('.upload-type').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      
      const uploadType = this.dataset.type;
      const businessFields = document.getElementById('businessFields');
      const mediaUpload = document.getElementById('mediaUpload');
      
      if (uploadType === 'business') {
        businessFields.style.display = 'block';
        mediaUpload.style.display = 'block';
      } else if (uploadType === 'image' || uploadType === 'video') {
        businessFields.style.display = 'none';
        mediaUpload.style.display = 'block';
      } else {
        businessFields.style.display = 'none';
        mediaUpload.style.display = 'none';
      }
    });
  });
  
  // Media upload preview
  document.getElementById('mediaUpload').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const preview = document.getElementById('uploadPreview');
    
    if (!file) {
      preview.innerHTML = `
        <div class="upload-preview-placeholder">
          <span class="material-icons" style="font-size:48px; color:var(--text-light)">add_photo_alternate</span>
          <p>Select an image or video to preview</p>
        </div>
      `;
      return;
    }
    
    if (file.type.startsWith('image/')) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.innerHTML = `<img src="${e.target.result}" style="max-width:100%; max-height:300px">`;
      };
      reader.readAsDataURL(file);
    } else if (file.type.startsWith('video/')) {
      const url = URL.createObjectURL(file);
      preview.innerHTML = `
        <video controls style="max-width:100%; max-height:300px">
          <source src="${url}" type="${file.type}">
        </video>
      `;
    }
  });
  
  // Chat input enter key
  document.getElementById('chatInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });
  
  // Close sidebar when clicking outside on mobile
  document.addEventListener('click', function(e) {
    const sidebar = document.getElementById('sidebar');
    if (window.innerWidth <= 768 && sidebar.classList.contains('active') && 
        !sidebar.contains(e.target) && 
        !e.target.closest('.header-left')) {
      sidebar.classList.remove('active');
    }
  });
});

// ========== POST INTERACTIONS ==========
function likePost(postId) {
  if (!currentUser) {
    alert('Please login to like posts');
    return;
  }
  
  const postRef = db.collection('posts').doc(postId);
  postRef.update({
    likes: firebase.firestore.FieldValue.increment(1)
  })
  .then(() => {
    // Update UI
    const likeBtn = event.target.closest('.post-action');
    likeBtn.classList.add('liked');
    likeBtn.querySelector('span.material-icons').textContent = 'thumb_up';
  })
  .catch(error => {
    console.error('Error liking post:', error);
  });
}

function commentOnPost(postId) {
  const comment = prompt('Enter your comment:');
  if (comment && currentUser) {
    const postRef = db.collection('posts').doc(postId);
    postRef.update({
      comments: firebase.firestore.FieldValue.increment(1)
    });
    
    // Add comment to subcollection in real app
    // postRef.collection('comments').add({...})
    
    alert('Comment added!');
  }
}

function sharePost(postId) {
  if (navigator.share) {
    navigator.share({
      title: 'Check out this post on LamEarn',
      url: window.location.href + '?post=' + postId
    });
  } else {
    alert('Post shared! (Link copied)');
    // In real app, copy link to clipboard
  }
  
  // Update share count
  db.collection('posts').doc(postId).update({
    shares: firebase.firestore.FieldValue.increment(1)
  });
}

function savePost(postId) {
  if (!currentUser) return;
  
  db.collection('users').doc(currentUser.uid).collection('saved').doc(postId).set({
    savedAt: firebase.firestore.FieldValue.serverTimestamp()
  })
  .then(() => {
    alert('Post saved to your collection!');
  })
  .catch(error => {
    console.error('Error saving post:', error);
  });
}

// ========== INITIALIZE ==========
// Set initial states
window.addEventListener('load', function() {
  // Check auth state
  auth.onAuthStateChanged(user => {
    if (user) {
      currentUser = user;
      document.getElementById('auth').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      showPage('home');
    }
  });
});
</script>
</body>
  </html>
